output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set == "neither")
return(expr_with_HGNC)
}
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set == "neither")
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
good_genes <- c("TMEM14C", "CPNE6")
bad_genes <- c("DCAF11")
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither")
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename(affy_hg_u133_plus_2 = "probeids")
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("affy_hg_u133_plus_2" = probeids)
return(expr_with_HGNC)
}
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("affy_hg_u133_plus_2" = probeids)
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("affy_hg_u133_plus_2" = "probeids")
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2")
return(expr_with_HGNC)
}
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2")
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
left_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2",
"hgnc" = "hgnc_symbol") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
reduce_test
expected_result
t_tibble
names
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2",
"hgnc" = "hgnc_symbol") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
inner_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2",
"hgnc" = "hgnc_symbol") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
t_tibble
names
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
inner_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2",
"hgnc" = "hgnc_symbol") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
right_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probeids" = "affy_hg_u133_plus_2",
"hgnc" = "hgnc_symbol") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
reduce_test
expected_result
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
right_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probe" = "affy_hg_u133_plus_2") %>%
select(probeids, hgnc, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
reduce_data <- function(expr_tibble, names_ids, good_genes, bad_genes){
expr_with_HGNC <- names_ids %>%
right_join(expr_tibble, by = c("affy_hg_u133_plus_2" = "probe")) %>%
mutate(gene_set = case_when(
hgnc_symbol %in% good_genes ~ "good",
hgnc_symbol %in% bad_genes ~ "bad",
TRUE ~ "neither")) %>%
filter(gene_set != "neither") %>%
rename("probe" = "affy_hg_u133_plus_2") %>%
select(probe, hgnc_symbol, gene_set, everything())
return(expr_with_HGNC)
}
output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
output
describe("reduce_data()", {
t_tibble <- tibble(probe = c("1_s_at", "2_s_at", "3_s_at"),
GSM1 = c(9.5, 7.6, 5.5),
GSM2 = c(9.7, 7.2, 2.9),
GSM3 = c(6.9, 4.3, 6.8))
names <- tibble(affy_hg_u133_plus_2 = c("1_s_at", "2_s_at", "3_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC", "UTWPU"))
good <- c("A-REAL-GENE")
bad <- c("SONIC")
reduce_test <- reduce_data(t_tibble, names, good, bad)
expected_result <- tibble(probe = c("1_s_at", "2_s_at"),
hgnc_symbol = c("A-REAL-GENE", "SONIC"),
gene_set = c("good", "bad"),
GSM1 = c(9.5, 7.6),
GSM2 = c(9.7, 7.2),
GSM3 = c(6.9, 4.3))
it("returns a reduced tibble with the specified columns", {
expect_equal(reduce_test, expected_result)
})
})
reduce_output <- reduce_data(expr_tibble, names_ids, good_genes, bad_genes)
reduce_output
convert_to_long <- function(tibble) {
long_tibble <- tibble %>%
pivot_longer(cols = starts_with("GSM"),
names_to = "sample",
values_to = "expression")
return(long_tibble)
}
output <- convert_to_long(reduce_output)
output
describe("convert_to_long()", {
# wide format tibble
wide_tib <- tibble(probe = c("202274_at", "202541_at", "202542_s_at", "203919_at"),
hgnc = c("ACTG2", "AIMP1", "AIMP1", "TCEA2"),
gene_set = rep("good", 4),
GSM1 = c(8.05, 8.40, 9.55, 4.44),
GSM2 = c(7.74, 7.11, 8.48, 5.39))
# expected long format tibble
expected_tib <- tibble(probe = rep(c("202274_at", "202541_at", "202542_s_at", "203919_at"), each = 2),
hgnc = rep(c("ACTG2", "AIMP1", "AIMP1", "TCEA2"), each = 2),
gene_set = rep(rep("good", 4), each = 2),
sample = rep(c("GSM1", "GSM2"), 4),
value = c(8.05, 7.74, 8.40, 7.11, 9.55, 8.48, 4.44, 5.39))
long_format <- convert_to_long(wide_tib)
#this tests for shape
it("correctly converts a wide format tibble to long format", {
expect_equal(long_format, expected_tib)
})
#this tests for column named properly
it("contains a column named sample", {
expect_true("sample" %in% colnames(long_format))
})
})
convert_to_long <- function(tibble) {
long_tibble <- tibble %>%
pivot_longer(cols = starts_with("GSM"),
names_to = "sample",
values_to = "expression")
return(long_tibble)
}
output <- convert_to_long(reduce_output)
output
wide_tib <- tibble(probe = c("202274_at", "202541_at", "202542_s_at", "203919_at"),
hgnc = c("ACTG2", "AIMP1", "AIMP1", "TCEA2"),
gene_set = rep("good", 4),
GSM1 = c(8.05, 8.40, 9.55, 4.44),
GSM2 = c(7.74, 7.11, 8.48, 5.39))
# expected long format tibble
expected_tib <- tibble(probe = rep(c("202274_at", "202541_at", "202542_s_at", "203919_at"), each = 2),
hgnc = rep(c("ACTG2", "AIMP1", "AIMP1", "TCEA2"), each = 2),
gene_set = rep(rep("good", 4), each = 2),
sample = rep(c("GSM1", "GSM2"), 4),
value = c(8.05, 7.74, 8.40, 7.11, 9.55, 8.48, 4.44, 5.39))
long_format <- convert_to_long(wide_tib)
wide_tib
long_format
convert_to_long <- function(tibble) {
long_tibble <- tibble %>%
pivot_longer(cols = starts_with("GSM"),
names_to = "sample",
values_to = "expression")
return(long_tibble)
}
output <- convert_to_long(reduce_output)
output
convert_to_long <- function(tibble) {
long_tibble <- tibble %>%
pivot_longer(cols = starts_with("GSM"),
names_to = "sample",
values_to = "expression") %>%
rename("hgnc" = "hgnc_symbol")
return(long_tibble)
}
output <- convert_to_long(reduce_output)
output
wide_tib
long_format
describe("convert_to_long()", {
# wide format tibble
wide_tib <- tibble(probe = c("202274_at", "202541_at", "202542_s_at", "203919_at"),
hgnc = c("ACTG2", "AIMP1", "AIMP1", "TCEA2"),
gene_set = rep("good", 4),
GSM1 = c(8.05, 8.40, 9.55, 4.44),
GSM2 = c(7.74, 7.11, 8.48, 5.39))
# expected long format tibble
expected_tib <- tibble(probe = rep(c("202274_at", "202541_at", "202542_s_at", "203919_at"), each = 2),
hgnc = rep(c("ACTG2", "AIMP1", "AIMP1", "TCEA2"), each = 2),
gene_set = rep(rep("good", 4), each = 2),
sample = rep(c("GSM1", "GSM2"), 4),
value = c(8.05, 7.74, 8.40, 7.11, 9.55, 8.48, 4.44, 5.39))
long_format <- convert_to_long(wide_tib)
#this tests for shape
it("correctly converts a wide format tibble to long format", {
expect_equal(long_format, expected_tib)
})
#this tests for column named properly
it("contains a column named sample", {
expect_true("sample" %in% colnames(long_format))
})
})
wide_tib
long_format
expected_tib
convert_to_long <- function(tibble) {
long_tibble <- tibble %>%
pivot_longer(cols = starts_with("GSM"),
names_to = "sample",
values_to = "value")
return(long_tibble)
}
output <- convert_to_long(reduce_output)
output
describe("convert_to_long()", {
# wide format tibble
wide_tib <- tibble(probe = c("202274_at", "202541_at", "202542_s_at", "203919_at"),
hgnc = c("ACTG2", "AIMP1", "AIMP1", "TCEA2"),
gene_set = rep("good", 4),
GSM1 = c(8.05, 8.40, 9.55, 4.44),
GSM2 = c(7.74, 7.11, 8.48, 5.39))
# expected long format tibble
expected_tib <- tibble(probe = rep(c("202274_at", "202541_at", "202542_s_at", "203919_at"), each = 2),
hgnc = rep(c("ACTG2", "AIMP1", "AIMP1", "TCEA2"), each = 2),
gene_set = rep(rep("good", 4), each = 2),
sample = rep(c("GSM1", "GSM2"), 4),
value = c(8.05, 7.74, 8.40, 7.11, 9.55, 8.48, 4.44, 5.39))
long_format <- convert_to_long(wide_tib)
#this tests for shape
it("correctly converts a wide format tibble to long format", {
expect_equal(long_format, expected_tib)
})
#this tests for column named properly
it("contains a column named sample", {
expect_true("sample" %in% colnames(long_format))
})
})
testthat::test_file('test_main.R')
knitr::opts_chunk$set(echo = TRUE)
# use source to load your functions from main.R into this document.
source("main.R")
